angular.module("giftSwitch",["appRoutes","mainCtrl","wishlistService","exchangeService","ng-sortable","moment-picker"]),angular.module("appRoutes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(e,n){e.when("/",{templateUrl:"app/views/pages/home.html"}).when("/recipient",{templateUrl:"app/views/pages/recipient.html",controller:"recipientController",controllerAs:"recipient"}).when("/settings",{templateUrl:"app/views/pages/settings.html",controller:"settingsController",controllerAs:"settings"}).when("/login",{templateUrl:"app/views/pages/login.html",controller:"mainController",controllerAs:"login"}),n.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("mainCtrl",["wishlistService","exchangeService","ng-sortable","moment-picker"]).controller("mainController",["$window","$scope","$location","Wishlist","Exchange",function(e,n,t,i,c){var r=this;r.loggedIn=!1,"/login"!==t.path()&&(r.loggedIn=!0,i.owner().success(function(e){r.owner=e}),c.all().success(function(e){r.exchanges=e,r.exchanges[0]?(r.currentExchange=r.exchanges[0].id,r.currentExchangeName=r.exchanges[0].name):r.currentExchange=null}).then(function(){i.all(r.currentExchange).success(function(e){r.wishlist=e})})),r.addItem=function(){i.add(r.currentExchange,r.userData).success(function(e){r.userData={},i.all(r.currentExchange).success(function(e){r.wishlist=e})})},r.updateItem=function(e,n){var t={};t.description=document.getElementsByName("newDescription")[n].value,t.url=document.getElementsByName("newUrl")[n].value,i.update(r.currentExchange,e,t).success(function(e){r.wishlist[n]=e})},r.removeItem=function(e){i.remove(r.currentExchange,e).success(function(e){i.all(r.currentExchange).success(function(e){r.wishlist=e})})},r.loadExchange=function(e,n){r.currentExchange=e,r.currentExchangeName=n,i.all(r.currentExchange).success(function(e){r.wishlist=e})},r.addExchange=function(){c.add(r.userData).success(function(e){n.dismiss(),n.reset(),c.all().success(function(e){r.exchanges=e})})},r.clearExchangeForm=function(){n.reset()},r.isActive=function(e){return e===t.path()},r.googleLogin=function(){e.location.href="/auth/google"},r.logOut=function(){e.location.href="/logout"}}]).directive("exchangeModal",function(){return{restrict:"A",link:function(e,n,t){e.dismiss=function(){n.modal("hide")},e.reset=function(){n.on("hidden.bs.modal",function(){$(this).find("form")[0].reset()})}}}}),angular.module("exchangeService",[]).factory("Exchange",["$http",function(e){var n={};return n.all=function(){return e.get("/api/exchange")},n.add=function(n){return e.post("/api/exchange",n)},n.update=function(n,t){return e.put("/api/exchange/"+n,t)},n["delete"]=function(n){return e["delete"]("/api/exchange/"+n)},n}]),angular.module("wishlistService",[]).factory("Wishlist",["$http",function(e){var n={};return n.owner=function(){return e.get("/api/me")},n.all=function(n){return e.get("/api/"+n+"/wishlist")},n.add=function(n,t){return e.post("/api/"+n+"/wishlist",t)},n.update=function(n,t,i){return e.put("/api/"+n+"/wishlist/"+t,i)},n.remove=function(n,t){return e["delete"]("/api/"+n+"/wishlist/"+t)},n}]);
angular.module("giftSwitch",["appRoutes","mainCtrl","exchangeCtrl","addExchangeModalCtrl","wishlistService","exchangeService","ng-sortable","moment-picker","angularModalService"]),angular.module("appRoutes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(e,n){e.when("/",{templateUrl:"app/views/pages/home.html"}).when("/recipient",{templateUrl:"app/views/pages/recipient.html",controller:"recipientController",controllerAs:"recipient"}).when("/settings",{templateUrl:"app/views/pages/settings.html",controller:"settingsController",controllerAs:"settings"}).when("/login",{templateUrl:"app/views/pages/login.html",controller:"mainController",controllerAs:"login"}),n.html5Mode({enabled:!0,requireBase:!1})}]),angular.module("addExchangeModalCtrl",["exchangeService","moment-picker"]).controller("addExchangeModalController",["$scope","$element","Exchange","close",function(e,n,t,a){e.cancel=function(){n.modal("hide"),a(null,500)},e.addExchange=function(){t.add(e.userData).success(function(e){t.all().success(function(e){a({exchanges:e},500)})})}}]),angular.module("exchangeCtrl",["exchangeService","wishlistService","angularModalService"]).controller("exchangeController",["$scope","Exchange","Wishlist","ModalService",function(e,n,t,a){var c=this;n.all().success(function(n){c.exchanges=n,c.exchanges[0]?(e.main.currentExchange=c.exchanges[0].id,e.main.currentExchangeName=c.exchanges[0].name):e.main.currentExchange=null}).then(function(){t.all(e.main.currentExchange).success(function(n){e.main.wishlist=n})}),c.loadExchange=function(n,a){e.main.currentExchange=n,e.main.currentExchangeName=a,t.all(e.main.currentExchange).success(function(n){e.main.wishlist=n})},c.showModal=function(){a.showModal({templateUrl:"app/views/pages/addExchangeModal.html",controller:"addExchangeModalController"}).then(function(e){e.element.modal(),e.close.then(function(e){e&&(c.exchanges=e.exchanges)})})}}]),angular.module("mainCtrl",["wishlistService","ng-sortable"]).controller("mainController",["$window","$location","Wishlist",function(e,n,t){var a=this;a.loggedIn=!1,"/login"!==n.path()&&(a.loggedIn=!0,t.owner().success(function(e){a.owner=e})),a.addItem=function(){t.add(a.currentExchange,a.userData).success(function(e){a.userData={},t.all(a.currentExchange).success(function(e){a.wishlist=e})})},a.updateItem=function(e,n){var c={};c.description=document.getElementsByName("newDescription")[n].value,c.url=document.getElementsByName("newUrl")[n].value,t.update(a.currentExchange,e,c).success(function(e){a.wishlist[n]=e})},a.removeItem=function(e){t.remove(a.currentExchange,e).success(function(e){t.all(a.currentExchange).success(function(e){a.wishlist=e})})},a.isActive=function(e){return e===n.path()},a.googleLogin=function(){e.location.href="/auth/google"},a.logOut=function(){e.location.href="/logout"}}]),angular.module("exchangeService",[]).factory("Exchange",["$http",function(e){var n={};return n.all=function(){return e.get("/api/exchange")},n.add=function(n){return e.post("/api/exchange",n)},n.update=function(n,t){return e.put("/api/exchange/"+n,t)},n["delete"]=function(n){return e["delete"]("/api/exchange/"+n)},n}]),angular.module("wishlistService",[]).factory("Wishlist",["$http",function(e){var n={};return n.owner=function(){return e.get("/api/me")},n.all=function(n){return e.get("/api/"+n+"/wishlist")},n.add=function(n,t){return e.post("/api/"+n+"/wishlist",t)},n.update=function(n,t,a){return e.put("/api/"+n+"/wishlist/"+t,a)},n.remove=function(n,t){return e["delete"]("/api/"+n+"/wishlist/"+t)},n}]);